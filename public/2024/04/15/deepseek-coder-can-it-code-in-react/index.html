<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Deepseek coder - Can it code in React? | KiloBytes by KB</title>
<meta name=keywords content="Machine-Learning,AI,LLM"><meta name=description content="Introduction The goal of this post is to deep-dive into LLMs that are specialized in code generation tasks and see if we can use them to write code.
Note: Unlike copilot, we&rsquo;ll focus on locally running LLM&rsquo;s. This should be appealing to any developers working in enterprises that have data privacy and sharing concerns, but still want to improve their developer productivity with locally running models.
To test our understanding, we&rsquo;ll perform a few simple coding tasks, compare the various methods in achieving the desired results, and also show the shortcomings."><meta name=author content><link rel=canonical href=https://Kshitij-Banerjee.github.io/2024/04/15/deepseek-coder-can-it-code-in-react/><link crossorigin=anonymous href=/assets/css/stylesheet.197da216ae0376a6e25536c67c59479922e8fce0dcc011f79bf6dcf38cf18663.css integrity="sha256-GX2iFq4DdqbiVTbGfFlHmSLo/ODcwBH3m/bc84zxhmM=" rel="preload stylesheet" as=style><link rel=icon href=https://Kshitij-Banerjee.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://Kshitij-Banerjee.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://Kshitij-Banerjee.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://Kshitij-Banerjee.github.io/apple-touch-icon.png><link rel=mask-icon href=https://Kshitij-Banerjee.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-KFSE3K3EMC"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-KFSE3K3EMC",{anonymize_ip:!1})}</script><meta property="og:title" content="Deepseek coder - Can it code in React?"><meta property="og:description" content="Introduction The goal of this post is to deep-dive into LLMs that are specialized in code generation tasks and see if we can use them to write code.
Note: Unlike copilot, we&rsquo;ll focus on locally running LLM&rsquo;s. This should be appealing to any developers working in enterprises that have data privacy and sharing concerns, but still want to improve their developer productivity with locally running models.
To test our understanding, we&rsquo;ll perform a few simple coding tasks, compare the various methods in achieving the desired results, and also show the shortcomings."><meta property="og:type" content="article"><meta property="og:url" content="https://Kshitij-Banerjee.github.io/2024/04/15/deepseek-coder-can-it-code-in-react/"><meta property="og:image" content="https://Kshitij-Banerjee.github.io/exploring_code_llms.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-04-15T00:00:00+00:00"><meta property="article:modified_time" content="2024-04-15T00:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://Kshitij-Banerjee.github.io/exploring_code_llms.png"><meta name=twitter:title content="Deepseek coder - Can it code in React?"><meta name=twitter:description content="Introduction The goal of this post is to deep-dive into LLMs that are specialized in code generation tasks and see if we can use them to write code.
Note: Unlike copilot, we&rsquo;ll focus on locally running LLM&rsquo;s. This should be appealing to any developers working in enterprises that have data privacy and sharing concerns, but still want to improve their developer productivity with locally running models.
To test our understanding, we&rsquo;ll perform a few simple coding tasks, compare the various methods in achieving the desired results, and also show the shortcomings."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://Kshitij-Banerjee.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Deepseek coder - Can it code in React?","item":"https://Kshitij-Banerjee.github.io/2024/04/15/deepseek-coder-can-it-code-in-react/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Deepseek coder - Can it code in React?","name":"Deepseek coder - Can it code in React?","description":"Introduction The goal of this post is to deep-dive into LLMs that are specialized in code generation tasks and see if we can use them to write code.\nNote: Unlike copilot, we\u0026rsquo;ll focus on locally running LLM\u0026rsquo;s. This should be appealing to any developers working in enterprises that have data privacy and sharing concerns, but still want to improve their developer productivity with locally running models.\nTo test our understanding, we\u0026rsquo;ll perform a few simple coding tasks, compare the various methods in achieving the desired results, and also show the shortcomings.","keywords":["Machine-Learning","AI","LLM"],"articleBody":"Introduction The goal of this post is to deep-dive into LLMs that are specialized in code generation tasks and see if we can use them to write code.\nNote: Unlike copilot, we‚Äôll focus on locally running LLM‚Äôs. This should be appealing to any developers working in enterprises that have data privacy and sharing concerns, but still want to improve their developer productivity with locally running models.\nTo test our understanding, we‚Äôll perform a few simple coding tasks, compare the various methods in achieving the desired results, and also show the shortcomings.\nIn Part-1, I covered some papers around instruction fine-tuning, GQA and Model Quantization - All of which make running LLM‚Äôs locally possible.\nIn this Part-2 of the series, I‚Äôd like to focus on how to setup an M1 to run deepseek-coder, and the verdict on its coding capabilities in react on a few tests\nThe tasks Test 1: Generate a higher-order-component / decorator that enables logging on a react component\nTest 2: Write a test plan, and implement the test cases\nTest 3: Parse an uploaded excel file in the browser.\nSetting Up the Environment: Ollama on M1 Option 1: Hosting the model To host the models, I chose the ollama project: https://ollama.com/\nOllama is essentially, docker for LLM models and allows us to quickly run various LLM‚Äôs and host them over standard completion APIs locally.\nThe website and documentation is pretty self-explanatory, so I wont go into the details of setting it up.\nOption 2: My machine is not strong enough, but I‚Äôd like to experiment If your machine doesn‚Äôt support these LLM‚Äôs well (unless you have an M1 and above, you‚Äôre in this category), then there is the following alternative solution I‚Äôve found.\nYou can rent machines relatively cheaply (~0.4$ / hour) for inference methods, using vast.ai\nOnce you‚Äôve setup an account, added your billing methods, and have copied your API key from settings.\nClone the llm-deploy repo, and follow the instructions.\nThis repo figures out the cheapest available machine and hosts the ollama model as a docker image on it.\nFrom 1 and 2, you should now have a hosted LLM model running. Now we need VSCode to call into these models and produce code.\nVSCode Extension Calling into the Model [UPDATE]: I‚Äôve recently found an open source plugin works well. If I was starting from scratch, I‚Äôd try https://www.continue.dev/.\nGiven the above best practices on how to provide the model its context, and the prompt engineering techniques that the authors suggested have positive outcomes on result. I created a VSCode plugin that implements these techniques, and is able to interact with Ollama running locally.\nThe source code for this plugin is available here:\nhttps://github.com/Kshitij-Banerjee/kb-ollama-coder\nThis plugin achieves the following:-\nIt provides the LLM context on project/repository relevant files.\nThe plugin not only pulls the current file, but also loads all the currently open files in Vscode into the LLM context.\nIt then trims the context to the last 16000/24000 characters (configurable)\nThis is an approximation, as deepseek coder enables 16K tokens, and approximate that each token is 1.5 tokens. In practice, I believe this can be much higher - so setting a higher value in the configuration should also work.\nIt adds a header prompt, based on the guidance from the paper. (Configurable) Example:-\n‚ÄúYou need to first write a step-by-step outline and then write the code. The following is a complete {LANG} file named {FILE_NAME} in the project {PROJECT_NAME}. Anything NOT code is written as a CODE COMMENT.‚Äù\nSource code The source code for this plugin is available here:\nhttps://github.com/Kshitij-Banerjee/kb-ollama-coder\nFor completeness, there are other VSCode plugins that might also solve a similar problem - and I am yet to try them\nhttps://github.com/rjmacarthy/twinny\nhttps://github.com/smallcloudai/refact\nhttps://github.com/TabbyML/tabby\nTesting DeepseekCoder General Observations For the most part, the 7b instruct model was quite useless and produces mostly error and incomplete responses.\nThe 33b models can do quite a few things correctly. However, it‚Äôs probably at the brink of usefulness\nThe model doesn‚Äôt really understand writing test cases at all.\nTest Setting For all the tests, I used a temperature setting of 0, as the guideline is to have lower temperatures for tasks like coding, instead of creative generation tasks (I find coding a pretty creative activity though, but just going with the guidelines for now)\nTest 1: Mount/Unmount logging using hooks and HOC In this task, I wanted to test its ability to understand basic react concepts of useEffect and hooks / HOC\n1.1 Writing custom hook with mount/unmount logging PROMPT\n// A react custom hook that logs the component name on mount and unmount CODE OUTPUT:\nimport { useEffect } from 'react'; export default function withLoggingHook(componentName: string) { return () =\u003e { useEffect(() =\u003e { console.log(`${componentName} mounted`); return () =\u003e { console.log(`${componentName} unmounted`); }; }, []); }; } Things to note:\nIt doesn‚Äôt know when to stop, and kind of keep spitting code at times - so I had to manually stop it\nVerdict üëç - Works as expected 1.2 Writing a HOC that augments the logging instead of using the hook. PROMPT:\n// A react HOC, that wraps a given component and logs the component name // on mount and unmount. CODE OUTPUT (Attempt 1):\nimport React from 'react'; export function withLoggingHook\u003cT extends {}\u003e( WrappedComponent: React.ComponentType\u003cT\u003e, ) { return class WithLoggingHoc extends React.PureComponent\u003cT, {}\u003e { constructor(props: T) { super(props); console.log('Mounted ' + WrappedComponent.name); } componentWillUnmount() { console.log('Unmounted ' + WrappedComponent.name); } render() { return \u003cWrappedComponent {...this.props} /\u003e; } }; } // ./src/generated/withLoggingHook.test.tsx import React from 'react'; import { render, fireEvent } from '@testing-library/react'; import { withLoggingHook } from './withLoggingHook'; const TestComponent = () =\u003e \u003cdiv\u003eTest Component\u003c/div\u003e; describe('withLoggingHook', () =\u003e { beforeEach(() =\u003e { jest.spyOn(console, 'log'); }); afterEach(() =\u003e { jest.resetAllMocks(); }); it('should log when mounted and unmounted', () =\u003e { const ComponentWithLogging = withLoggingHook(TestComponent); const { rerender, unmount } = render(\u003cComponentWithLogging /\u003e); expect(console.log).toHaveBeenCalledWith('Mounted TestComponent'); rerender(\u003cdiv\u003e\u003c/div\u003e); expect(console.log).not.toHaveBeenLastCalledWith('Unmounted TestComponent'); unmount(); expect(console.log).toHaveBeenLastCalledWith('Unmounted TestComponent'); }); }); Mistakes: It used a constructor, instead of the componentDidMount method.\nadded a fireEvent import, but didn‚Äôt use it later.\nRetry: I retried a couple more times. In the next attempt, it jumbled the output and got things completely wrong.\nAttempt 3 is did pretty well though\nCODE OUTPUT (Attempt 3):\n// A react HOC, that wraps a given component and logs the component name // on mount and unmount. import React from 'react'; import { useEffect } from 'react'; import { ComponentType } from 'react'; export function withLoggingHook\u003cTProps\u003e( WrappedComponent: ComponentType\u003cTProps\u003e, componentName: string, ) { const WithLogging = (props: TProps) =\u003e { useEffect(() =\u003e { console.log(`${componentName} is mounted`); return () =\u003e { console.log(`${componentName} is unmounted`); }; }, []); return \u003cWrappedComponent {...props} /\u003e; }; WithLogging.displayName = `WithLogging(${getDisplayName(WrappedComponent)})`; return WithLogging; } function getDisplayName\u003cTProps\u003e(WrappedComponent: ComponentType\u003cTProps\u003e) { return WrappedComponent.displayName || WrappedComponent.name || 'Component'; } I also noticed, that asking it specifically what I want, returned the right output in the first attempt\nCODE OUTPUT (Attempt 4): asking explicitly what I want\n// A react HOC, that wraps a given component and logs the component name // on mount and unmount. Use effects, instead of componentDidMount / unmount import React from 'react'; export function withLoggingHook\u003cP extends object\u003e( Component: React.ComponentType\u003cP\u003e, ) { return (props: P): JSX.Element =\u003e { console.log('[withLoggingHook]', Component.name, 'mounted'); React.useEffect(() =\u003e { return () =\u003e console.log('[withLoggingHook]', Component.name, 'un-mounted'); }, []); return \u003cComponent {...props} /\u003e; }; } Verdict: üëç It‚Äôs able to write basic hooks, but makes some errors with HOCs\nSometimes, it automatically wrote the test case for the code it generated, which was a pleasant surprise!\nRetrying a few times leads to automatically producing a better answer.\nComponent.name, is not defined, so that seems like a bug.\nPotential future experiments Experimenting with n, top_p ,and top_k parameters, and enabling the LLM to try multiple completions\nUsing a ‚ÄòVerifier‚Äô agent, that checks the completion for compilation and validity and retries\nGiving it concrete examples, that it can follow.\nTest 2: Write a test plan, and implement the test cases Next, let‚Äôs test its test case writing abilities\nTest 2.1 - Writing tests for withLoggingHook In the previous test, it wrote a withLoggingHook, let‚Äôs use that as its context\nAs mentioned before, I used the vscode plugin I created previously, to give it context of the withLoggingHooks code\nPROMPT:\n// [FILE-NAME] ./src/generated/withLoggingHook.tsx // A react HOC, that wraps a given component and logs the component name // on mount and unmount. Use effects, instead of componentDidMount / unmount ... code from withLogginHook\u003cP\u003e ... // [FILE-NAME] generatedApps/DoctorFinderApp/doctor-finder-app/src/generated/withLoggingHook.spec.tsx // Test cases for withLoggingHook CODE OUTPUT:\nimport { render } from '@testing-library/react'; import { withLoggingHook } from './withLoggingHook'; describe('withLoggingHook', () =\u003e { beforeEach(() =\u003e { // Mock console.log to prevent unwanted output during testing jest.spyOn(console, 'log').mockImplementation(() =\u003e {}); }); afterEach(() =\u003e { // Restore original console.log after each test (console.log as jest.Mock).mockRestore(); }); it('should log the component name on mount', () =\u003e { const TestComponent = withLoggingHook((): null =\u003e null); render(\u003cTestComponent /\u003e); expect(console.log).toHaveBeenCalledWith( '[withLoggingHook]', 'TestComponent', 'mounted', ); }); it('should log the component name on unmount', () =\u003e { const TestComponent = withLoggingHook((): null =\u003e null); const { unmount } = render(\u003cTestComponent /\u003e); unmount(); expect(console.log).toHaveBeenCalledWith( '[withLoggingHook]', 'TestComponent', 'un-mounted', ); }); }); Mistakes: The test case in itself is fine, the issue with the withLoggingHook causes the tests to fail\nHowever, I did realise that multiple attempts on the same test case did not always lead to promising results.\nVerdict: üëé For simple test cases, it works quite well, but just barely.\nAnything more complex, it kinda makes too many bugs to be productively useful.\nTask 3: Excel Upload Component Let‚Äôs ask it to make a slightly more complicated component with some functionality\nPROMPT\n// A react component, that allows the user to upload excel files. // The excel file has one sheet, and that sheet has two columns // Columns headers are foo, and bar, and both should have number values. // When the file is uploaded, it is parsed using XLSX. // The final parsed values of foo and bar, are given back as an array to the callback. CODE OUTPUT:\nimport React from 'react'; import XLSX from 'xlsx'; interface ExcelUploadComponentProps { onFileLoad: (data: { foo: number[]; bar: number[] }) =\u003e void; } const ExcelUploadComponent: React.FC\u003cExcelUploadComponentProps\u003e = ({ onFileLoad, }: ExcelUploadComponentProps) =\u003e { const handleChange = (e: React.ChangeEvent\u003cHTMLInputElement\u003e) =\u003e { if (!e.target.files || e.target.files.length === 0) return; const file = e.target.files[0]; const reader = new FileReader(); reader.onload = (event: ProgressEvent\u003cFileReader\u003e) =\u003e { if (!event.target || !event.target.result) return; const data = event.target.result as string; const workbook = XLSX.read(data, { type: 'binary' }); const sheetName = workbook.SheetNames[0]; const worksheet = workbook.Sheets[sheetName]; // Convert the excel data to JSON const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 }); // Extract the foo and bar values from the JSON data const fooValues = []; const barValues = []; for (let i = 0; i \u003c jsonData.length; i++) { if (!jsonData[i]) continue; const row = jsonData[i]; fooValues.push(row[0]); barValues.push(row[1]); } onFileLoad({ foo: fooValues, bar: barValues }); }; reader.readAsBinaryString(file); }; return \u003cinput type=\"file\" accept=\".xls,.xlsx,.csv\" onChange={handleChange} /\u003e; }; export default ExcelUploadComponent; Verdict: üëç üëç Now that, was pretty good. I have no idea how to use the xlsx utility, and have not looked at its documentation\nEven though, I had to correct some typos and some other minor edits - this gave me a component that does exactly what I needed.\nI‚Äôd say this save me atleast 10-15 minutes of time googling for the api documentation and fumbling till I got it right.\nConclusion All in all, I think having locally running LLMs that can help us with code is possibly very near\nThese current models, while don‚Äôt really get things correct always, do provide a pretty handy tool and in situations where new territory / new apps are being made, I think they can make significant progress.\nSomething to note, is that once I provide more longer contexts, the model seems to make a lot more errors. This is potentially only model specific, so future experimentation is needed here.\nWhat‚Äôs next There were quite a few things I didn‚Äôt explore here. I will cover those in future posts.\nHere‚Äôs a list of a few things I‚Äôm going to experiment next\nProviding more examples of good code, instead of trying to explicitly mention every detail we want\nComparing other models on similar exercises. Possibly making a benchmark test suite to compare them against.\nTrying multi-agent setups. I having another LLM that can correct the first ones mistakes, or enter into a dialogue where two minds reach a better outcome is totally possible.\n‚Äì A hint on this, is that once it gets something wrong, and I add the mistake to the prompt - the next iteration of the output is usually much better.\n","wordCount":"2111","inLanguage":"en","image":"https://Kshitij-Banerjee.github.io/exploring_code_llms.png","datePublished":"2024-04-15T00:00:00Z","dateModified":"2024-04-15T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://Kshitij-Banerjee.github.io/2024/04/15/deepseek-coder-can-it-code-in-react/"},"publisher":{"@type":"Organization","name":"KiloBytes by KB","logo":{"@type":"ImageObject","url":"https://Kshitij-Banerjee.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://Kshitij-Banerjee.github.io accesskey=h title="KiloBytes by KB (Alt + H)">KiloBytes by KB</a><div class=logo-switches></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Deepseek coder - Can it code in React?</h1><div class=post-meta><span title='2024-04-15 00:00:00 +0000 UTC'>April 15, 2024</span></div></header><figure class=entry-cover><img loading=eager src=https://Kshitij-Banerjee.github.io/exploring_code_llms.png alt></figure><div style=display:flex;justify-content:center;align-items:center><iframe src=https://kilobytes.substack.com/embed width=480 height=150 style="border:none;background:0 0" frameborder=0 scrolling=no></iframe></div><div class=post-content><h1 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h1><p>The goal of this post is to deep-dive into LLMs that are <strong>specialized in code generation tasks</strong> and see if we can use them to write code.</p><p>Note: Unlike copilot, we&rsquo;ll focus on <em>locally running LLM&rsquo;s</em>. This should be appealing to any developers working in enterprises that have data privacy and sharing concerns, but still want to improve their developer productivity with locally running models.</p><p>To test our understanding, we&rsquo;ll perform a few simple coding tasks, compare the various methods in achieving the desired results, and also show the shortcomings.</p><p>In <a href=https://kshitij-banerjee.github.io/2024/04/14/exploring-code-llms/>Part-1</a>, I covered some papers around instruction fine-tuning, GQA and Model Quantization - All of which make running LLM&rsquo;s locally possible.</p><p>In this Part-2 of the series, I&rsquo;d like to focus on how to setup an M1 to run deepseek-coder, and the verdict on its coding capabilities in react on a few tests</p><h2 id=the-tasks>The tasks<a hidden class=anchor aria-hidden=true href=#the-tasks>#</a></h2><ol><li><p>Test 1: Generate a higher-order-component / decorator that enables logging on a react component</p></li><li><p>Test 2: Write a test plan, and implement the test cases</p></li><li><p>Test 3: Parse an uploaded excel file in the browser.</p></li></ol><h1 id=setting-up-the-environment-ollama-on-m1>Setting Up the Environment: Ollama on M1<a hidden class=anchor aria-hidden=true href=#setting-up-the-environment-ollama-on-m1>#</a></h1><h2 id=option-1-hosting-the-model>Option 1: Hosting the model<a hidden class=anchor aria-hidden=true href=#option-1-hosting-the-model>#</a></h2><p>To host the models, I chose the ollama project: <a href=https://ollama.com/>https://ollama.com/</a></p><p>Ollama is essentially, docker for LLM models and allows us to quickly run various LLM&rsquo;s and host them over standard completion APIs locally.</p><p>The website and documentation is pretty self-explanatory, so I wont go into the details of setting it up.</p><h2 id=option-2-my-machine-is-not-strong-enough-but-id-like-to-experiment>Option 2: My machine is not strong enough, but I&rsquo;d like to experiment<a hidden class=anchor aria-hidden=true href=#option-2-my-machine-is-not-strong-enough-but-id-like-to-experiment>#</a></h2><p>If your machine doesn&rsquo;t support these LLM&rsquo;s well (unless you have an M1 and above, you&rsquo;re in this category), then there is the following alternative solution I&rsquo;ve found.</p><p>You can rent machines relatively cheaply (~0.4$ / hour) for inference methods, using <a href=https://vast.ai/>vast.ai</a></p><p>Once you&rsquo;ve setup an account, added your billing methods, and have copied your API key from settings.</p><p>Clone the <a href=https://github.com/g1ibby/llm-deploy>llm-deploy repo</a>, and follow the instructions.</p><p>This repo figures out the cheapest available machine and hosts the ollama model as a docker image on it.</p><p>From 1 and 2, you should now have a hosted LLM model running. Now we need VSCode to call into these models and produce code.</p><h2 id=vscode-extension-calling-into-the-model>VSCode Extension Calling into the Model<a hidden class=anchor aria-hidden=true href=#vscode-extension-calling-into-the-model>#</a></h2><p><strong>[UPDATE]</strong>: I&rsquo;ve recently found an open source plugin works well. If I was starting from scratch, I&rsquo;d try <a href=https://www.continue.dev/>https://www.continue.dev/</a>.</p><p>Given the above best practices on how to provide the model its context, and the prompt engineering techniques that the authors suggested have positive outcomes on result. I created a VSCode plugin that implements these techniques, and is able to interact with Ollama running locally.</p><p>The source code for this plugin is available here:</p><p><a href=https://github.com/Kshitij-Banerjee/kb-ollama-coder>https://github.com/Kshitij-Banerjee/kb-ollama-coder</a></p><p>This plugin achieves the following:-</p><p>It provides the LLM context on project/repository relevant files.</p><p>The plugin not only pulls the current file, but also loads all the currently open files in Vscode into the LLM context.</p><p>It then trims the context to the last 16000/24000 characters (configurable)</p><p>This is an approximation, as deepseek coder enables 16K tokens, and approximate that each token is 1.5 tokens. In practice, I believe this can be much higher - so setting a higher value in the configuration should also work.</p><p>It adds a header prompt, based on the guidance from the paper. (Configurable) Example:-</p><p>&ldquo;You need to first write a step-by-step outline and then write the code. The following is a complete {LANG} file named {FILE_NAME} in the project {PROJECT_NAME}. Anything NOT code is written as a CODE COMMENT.&rdquo;</p><h2 id=source-code>Source code<a hidden class=anchor aria-hidden=true href=#source-code>#</a></h2><p>The source code for this plugin is available here:</p><p><a href=https://github.com/Kshitij-Banerjee/kb-ollama-coder>https://github.com/Kshitij-Banerjee/kb-ollama-coder</a></p><p>For completeness, there are other VSCode plugins that might also solve a similar problem - and I am yet to try them</p><p><a href=https://github.com/rjmacarthy/twinny>https://github.com/rjmacarthy/twinny</a></p><p><a href=https://github.com/smallcloudai/refact>https://github.com/smallcloudai/refact</a></p><p><a href=https://github.com/TabbyML/tabby>https://github.com/TabbyML/tabby</a></p><h1 id=testing-deepseekcoder>Testing DeepseekCoder<a hidden class=anchor aria-hidden=true href=#testing-deepseekcoder>#</a></h1><h2 id=general-observations>General Observations<a hidden class=anchor aria-hidden=true href=#general-observations>#</a></h2><p>For the most part, the 7b instruct model was quite useless and produces mostly error and incomplete responses.</p><p>The 33b models can do quite a few things correctly. However, it&rsquo;s probably at the brink of usefulness</p><p>The model doesn&rsquo;t really understand writing test cases at all.</p><h2 id=test-setting>Test Setting<a hidden class=anchor aria-hidden=true href=#test-setting>#</a></h2><p>For all the tests, I used a temperature setting of 0, as the guideline is to have lower temperatures for tasks like coding, instead of creative generation tasks (I find coding a pretty creative activity though, but just going with the guidelines for now)</p><h2 id=test-1-mountunmount-logging-using-hooks-and-hoc>Test 1: Mount/Unmount logging using hooks and HOC<a hidden class=anchor aria-hidden=true href=#test-1-mountunmount-logging-using-hooks-and-hoc>#</a></h2><p>In this task, I wanted to test its ability to understand basic react concepts of useEffect and hooks / HOC</p><h3 id=11-writing-custom-hook-with-mountunmount-logging>1.1 Writing custom hook with mount/unmount logging<a hidden class=anchor aria-hidden=true href=#11-writing-custom-hook-with-mountunmount-logging>#</a></h3><p>PROMPT</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// A react custom hook that logs the component name on mount and unmount
</span></span></span></code></pre></div><p>CODE OUTPUT:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>useEffect</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>withLoggingHook</span>(<span style=color:#a6e22e>componentName</span>: <span style=color:#66d9ef>string</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>useEffect</span>(() <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>componentName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> mounted`</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>componentName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> unmounted`</span>);
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>    }, []);
</span></span><span style=display:flex><span>  };
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>Things to note:</strong></p><p>It doesn&rsquo;t know when to stop, and kind of keep spitting code at times - so I had to manually stop it</p><h3 id=verdict>Verdict<a hidden class=anchor aria-hidden=true href=#verdict>#</a></h3><ul><li>üëç - Works as expected</li></ul><h3 id=12-writing-a-hoc-that-augments-the-logging-instead-of-using-the-hook>1.2 Writing a HOC that augments the logging instead of using the hook.<a hidden class=anchor aria-hidden=true href=#12-writing-a-hoc-that-augments-the-logging-instead-of-using-the-hook>#</a></h3><p><em>PROMPT:</em></p><pre tabindex=0><code class=language-tyepscript data-lang=tyepscript>// A react HOC, that wraps a given component and logs the component name
// on mount and unmount.
</code></pre><p><em>CODE OUTPUT (Attempt 1):</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>withLoggingHook</span>&lt;<span style=color:#f92672>T</span> <span style=color:#a6e22e>extends</span> {}&gt;(
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>WrappedComponent</span>: <span style=color:#66d9ef>React.ComponentType</span>&lt;<span style=color:#f92672>T</span>&gt;,
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>WithLoggingHoc</span> <span style=color:#66d9ef>extends</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>PureComponent</span>&lt;<span style=color:#f92672>T</span><span style=color:#960050;background-color:#1e0010>,</span> {}&gt; {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>constructor</span>(<span style=color:#a6e22e>props</span>: <span style=color:#66d9ef>T</span>) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>super</span>(<span style=color:#a6e22e>props</span>);
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Mounted &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>WrappedComponent</span>.<span style=color:#a6e22e>name</span>);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>componentWillUnmount() {</span>
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Unmounted &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>WrappedComponent</span>.<span style=color:#a6e22e>name</span>);
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>render() {</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>WrappedComponent</span> {<span style=color:#a6e22e>...this.props</span>} /&gt;;
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	};
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ./src/generated/withLoggingHook.test.tsx
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>render</span>, <span style=color:#a6e22e>fireEvent</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@testing-library/react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>withLoggingHook</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./withLoggingHook&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>TestComponent</span> <span style=color:#f92672>=</span> () <span style=color:#f92672>=&gt;</span> &lt;<span style=color:#f92672>div</span>&gt;<span style=color:#a6e22e>Test</span> <span style=color:#a6e22e>Component</span>&lt;/<span style=color:#f92672>div</span>&gt;;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>describe</span>(<span style=color:#e6db74>&#39;withLoggingHook&#39;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>beforeEach</span>(() <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>jest</span>.<span style=color:#a6e22e>spyOn</span>(<span style=color:#a6e22e>console</span>, <span style=color:#e6db74>&#39;log&#39;</span>);
</span></span><span style=display:flex><span>	});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>afterEach</span>(() <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>jest</span>.<span style=color:#a6e22e>resetAllMocks</span>();
</span></span><span style=display:flex><span>	});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>it</span>(<span style=color:#e6db74>&#39;should log when mounted and unmounted&#39;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ComponentWithLogging</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>withLoggingHook</span>(<span style=color:#a6e22e>TestComponent</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>rerender</span>, <span style=color:#a6e22e>unmount</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>render</span>(&lt;<span style=color:#f92672>ComponentWithLogging</span> /&gt;);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>).<span style=color:#a6e22e>toHaveBeenCalledWith</span>(<span style=color:#e6db74>&#39;Mounted TestComponent&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>rerender</span>(&lt;<span style=color:#f92672>div</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>).<span style=color:#a6e22e>not</span>.<span style=color:#a6e22e>toHaveBeenLastCalledWith</span>(<span style=color:#e6db74>&#39;Unmounted TestComponent&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>unmount</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>).<span style=color:#a6e22e>toHaveBeenLastCalledWith</span>(<span style=color:#e6db74>&#39;Unmounted TestComponent&#39;</span>);
</span></span><span style=display:flex><span>	});
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h4 id=mistakes>Mistakes:<a hidden class=anchor aria-hidden=true href=#mistakes>#</a></h4><p>It used a constructor, instead of the componentDidMount method.</p><p>added a fireEvent import, but didn&rsquo;t use it later.</p><h4 id=retry>Retry:<a hidden class=anchor aria-hidden=true href=#retry>#</a></h4><p>I retried a couple more times. In the next attempt, it jumbled the output and got things completely wrong.</p><p>Attempt 3 is did pretty well though</p><p><em>CODE OUTPUT (Attempt 3):</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// A react HOC, that wraps a given component and logs the component name
</span></span></span><span style=display:flex><span><span style=color:#75715e>// on mount and unmount.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>useEffect</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>ComponentType</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>withLoggingHook</span>&lt;<span style=color:#f92672>TProps</span>&gt;(
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>WrappedComponent</span>: <span style=color:#66d9ef>ComponentType</span>&lt;<span style=color:#f92672>TProps</span>&gt;,
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>componentName</span>: <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>WithLogging</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>props</span>: <span style=color:#66d9ef>TProps</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>useEffect</span>(() <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>componentName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> is mounted`</span>);
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>componentName</span><span style=color:#e6db74>}</span><span style=color:#e6db74> is unmounted`</span>);
</span></span><span style=display:flex><span>			};
</span></span><span style=display:flex><span>		}, []);
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>WrappedComponent</span> {<span style=color:#a6e22e>...props</span>} /&gt;;
</span></span><span style=display:flex><span>	};
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>WithLogging</span>.<span style=color:#a6e22e>displayName</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`WithLogging(</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>getDisplayName</span>(<span style=color:#a6e22e>WrappedComponent</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>)`</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>WithLogging</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getDisplayName</span>&lt;<span style=color:#f92672>TProps</span>&gt;(<span style=color:#a6e22e>WrappedComponent</span>: <span style=color:#66d9ef>ComponentType</span>&lt;<span style=color:#f92672>TProps</span>&gt;) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>WrappedComponent</span>.<span style=color:#a6e22e>displayName</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>WrappedComponent</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;Component&#39;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>I also noticed, that asking it specifically what I want, returned the right output in the first attempt</p><p><em>CODE OUTPUT (Attempt 4): asking explicitly what I want</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// A react HOC, that wraps a given component and logs the component name
</span></span></span><span style=display:flex><span><span style=color:#75715e>// on mount and unmount. Use effects, instead of componentDidMount / unmount
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>withLoggingHook</span>&lt;<span style=color:#f92672>P</span> <span style=color:#a6e22e>extends</span> <span style=color:#a6e22e>object</span>&gt;(
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Component</span>: <span style=color:#66d9ef>React.ComponentType</span>&lt;<span style=color:#f92672>P</span>&gt;,
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> (<span style=color:#a6e22e>props</span>: <span style=color:#66d9ef>P</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>JSX</span>.<span style=color:#a6e22e>Element</span> <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;[withLoggingHook]&#39;</span>, <span style=color:#a6e22e>Component</span>.<span style=color:#a6e22e>name</span>, <span style=color:#e6db74>&#39;mounted&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>useEffect</span>(() <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> () <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;[withLoggingHook]&#39;</span>, <span style=color:#a6e22e>Component</span>.<span style=color:#a6e22e>name</span>, <span style=color:#e6db74>&#39;un-mounted&#39;</span>);
</span></span><span style=display:flex><span>		}, []);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>Component</span> {<span style=color:#a6e22e>...props</span>} /&gt;;
</span></span><span style=display:flex><span>	};
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=verdict->Verdict: üëç<a hidden class=anchor aria-hidden=true href=#verdict->#</a></h3><p>It&rsquo;s able to write basic hooks, but makes some errors with HOCs</p><p>Sometimes, it automatically wrote the test case for the code it generated, which was a pleasant surprise!</p><p>Retrying a few times leads to automatically producing a better answer.</p><p>Component.name, is not defined, so that seems like a bug.</p><h4 id=potential-future-experiments>Potential future experiments<a hidden class=anchor aria-hidden=true href=#potential-future-experiments>#</a></h4><p>Experimenting with <a href=https://platform.openai.com/docs/api-reference/chat/create#chat-create-n>n, top_p ,and top_k parameters</a>, and enabling the LLM to try multiple completions</p><p>Using a &lsquo;Verifier&rsquo; agent, that checks the completion for compilation and validity and retries</p><p>Giving it concrete examples, that it can follow.</p><h2 id=test-2-write-a-test-plan-and-implement-the-test-cases>Test 2: Write a test plan, and implement the test cases<a hidden class=anchor aria-hidden=true href=#test-2-write-a-test-plan-and-implement-the-test-cases>#</a></h2><p>Next, let&rsquo;s test its test case writing abilities</p><h3 id=test-21---writing-tests-for-withlogginghook>Test 2.1 - Writing tests for withLoggingHook<a hidden class=anchor aria-hidden=true href=#test-21---writing-tests-for-withlogginghook>#</a></h3><p>In the previous test, it wrote a withLoggingHook, let&rsquo;s use that as its context</p><p>As mentioned before, I used the vscode plugin I created previously, to give it context of the withLoggingHooks code</p><p><em>PROMPT:</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// [FILE-NAME] ./src/generated/withLoggingHook.tsx
</span></span></span><span style=display:flex><span><span style=color:#75715e>// A react HOC, that wraps a given component and logs the component name
</span></span></span><span style=display:flex><span><span style=color:#75715e>// on mount and unmount. Use effects, instead of componentDidMount / unmount
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>... <span style=color:#a6e22e>code</span> <span style=color:#66d9ef>from</span> <span style=color:#a6e22e>withLogginHook</span>&lt;<span style=color:#f92672>P</span>&gt; ...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// [FILE-NAME] generatedApps/DoctorFinderApp/doctor-finder-app/src/generated/withLoggingHook.spec.tsx
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Test cases for withLoggingHook
</span></span></span></code></pre></div><p><em>CODE OUTPUT:</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>render</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;@testing-library/react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>withLoggingHook</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./withLoggingHook&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>describe</span>(<span style=color:#e6db74>&#39;withLoggingHook&#39;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>beforeEach</span>(() <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#75715e>// Mock console.log to prevent unwanted output during testing
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		<span style=color:#a6e22e>jest</span>.<span style=color:#a6e22e>spyOn</span>(<span style=color:#a6e22e>console</span>, <span style=color:#e6db74>&#39;log&#39;</span>).<span style=color:#a6e22e>mockImplementation</span>(() <span style=color:#f92672>=&gt;</span> {});
</span></span><span style=display:flex><span>	});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>afterEach</span>(() <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#75715e>// Restore original console.log after each test
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>		(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span> <span style=color:#66d9ef>as</span> <span style=color:#a6e22e>jest</span>.<span style=color:#a6e22e>Mock</span>).<span style=color:#a6e22e>mockRestore</span>();
</span></span><span style=display:flex><span>	});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>it</span>(<span style=color:#e6db74>&#39;should log the component name on mount&#39;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>TestComponent</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>withLoggingHook</span>(()<span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>render</span>(&lt;<span style=color:#f92672>TestComponent</span> /&gt;);
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>).<span style=color:#a6e22e>toHaveBeenCalledWith</span>(
</span></span><span style=display:flex><span>			<span style=color:#e6db74>&#39;[withLoggingHook]&#39;</span>,
</span></span><span style=display:flex><span>			<span style=color:#e6db74>&#39;TestComponent&#39;</span>,
</span></span><span style=display:flex><span>			<span style=color:#e6db74>&#39;mounted&#39;</span>,
</span></span><span style=display:flex><span>		);
</span></span><span style=display:flex><span>	});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>it</span>(<span style=color:#e6db74>&#39;should log the component name on unmount&#39;</span>, () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>TestComponent</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>withLoggingHook</span>(()<span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>unmount</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>render</span>(&lt;<span style=color:#f92672>TestComponent</span> /&gt;);
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>unmount</span>();
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>).<span style=color:#a6e22e>toHaveBeenCalledWith</span>(
</span></span><span style=display:flex><span>			<span style=color:#e6db74>&#39;[withLoggingHook]&#39;</span>,
</span></span><span style=display:flex><span>			<span style=color:#e6db74>&#39;TestComponent&#39;</span>,
</span></span><span style=display:flex><span>			<span style=color:#e6db74>&#39;un-mounted&#39;</span>,
</span></span><span style=display:flex><span>		);
</span></span><span style=display:flex><span>	});
</span></span><span style=display:flex><span>});
</span></span></code></pre></div><h3 id=mistakes-1>Mistakes:<a hidden class=anchor aria-hidden=true href=#mistakes-1>#</a></h3><p>The test case in itself is fine, the issue with the withLoggingHook causes the tests to fail</p><p>However, I did realise that multiple attempts on the same test case did not always lead to promising results.</p><h3 id=verdict--1>Verdict: üëé<a hidden class=anchor aria-hidden=true href=#verdict--1>#</a></h3><ul><li><p>For simple test cases, it works quite well, but just barely.</p></li><li><p>Anything more complex, it kinda makes too many bugs to be productively useful.</p></li></ul><h2 id=task-3-excel-upload-component>Task 3: Excel Upload Component<a hidden class=anchor aria-hidden=true href=#task-3-excel-upload-component>#</a></h2><p>Let&rsquo;s ask it to make a slightly more complicated component with some functionality</p><p><em>PROMPT</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#75715e>// A react component, that allows the user to upload excel files.
</span></span></span><span style=display:flex><span><span style=color:#75715e>// The excel file has one sheet, and that sheet has two columns
</span></span></span><span style=display:flex><span><span style=color:#75715e>// Columns headers are foo, and bar, and both should have number values.
</span></span></span><span style=display:flex><span><span style=color:#75715e>// When the file is uploaded, it is parsed using XLSX.
</span></span></span><span style=display:flex><span><span style=color:#75715e>// The final parsed values of foo and bar, are given back as an array to the callback.
</span></span></span></code></pre></div><p><em>CODE OUTPUT:</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>React</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;react&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>XLSX</span> <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;xlsx&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>ExcelUploadComponentProps</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>onFileLoad</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>data</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>foo</span>: <span style=color:#66d9ef>number</span>[]; <span style=color:#a6e22e>bar</span>: <span style=color:#66d9ef>number</span>[] }) <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>void</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ExcelUploadComponent</span>: <span style=color:#66d9ef>React.FC</span>&lt;<span style=color:#f92672>ExcelUploadComponentProps</span>&gt; <span style=color:#f92672>=</span> ({
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>onFileLoad</span>,
</span></span><span style=display:flex><span>}<span style=color:#f92672>:</span> <span style=color:#a6e22e>ExcelUploadComponentProps</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleChange</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>e</span>: <span style=color:#66d9ef>React.ChangeEvent</span>&lt;<span style=color:#f92672>HTMLInputElement</span>&gt;) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>files</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>files</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>file</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>files</span>[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>reader</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>FileReader</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>reader</span>.<span style=color:#a6e22e>onload</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>event</span>: <span style=color:#66d9ef>ProgressEvent</span>&lt;<span style=color:#f92672>FileReader</span>&gt;) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>target</span> <span style=color:#f92672>||</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>result</span>) <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>target</span>.<span style=color:#a6e22e>result</span> <span style=color:#66d9ef>as</span> <span style=color:#66d9ef>string</span>;
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>workbook</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>XLSX</span>.<span style=color:#a6e22e>read</span>(<span style=color:#a6e22e>data</span>, { <span style=color:#66d9ef>type</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;binary&#39;</span> });
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sheetName</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>workbook</span>.<span style=color:#a6e22e>SheetNames</span>[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>worksheet</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>workbook</span>.<span style=color:#a6e22e>Sheets</span>[<span style=color:#a6e22e>sheetName</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#75715e>// Convert the excel data to JSON
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>jsonData</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>XLSX</span>.<span style=color:#a6e22e>utils</span>.<span style=color:#a6e22e>sheet_to_json</span>(<span style=color:#a6e22e>worksheet</span>, { <span style=color:#a6e22e>header</span>: <span style=color:#66d9ef>1</span> });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#75715e>// Extract the foo and bar values from the JSON data
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>			<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>fooValues</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>barValues</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>jsonData</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>jsonData</span>[<span style=color:#a6e22e>i</span>]) <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>jsonData</span>[<span style=color:#a6e22e>i</span>];
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>fooValues</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>row</span>[<span style=color:#ae81ff>0</span>]);
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>barValues</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>row</span>[<span style=color:#ae81ff>1</span>]);
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>onFileLoad</span>({ <span style=color:#a6e22e>foo</span>: <span style=color:#66d9ef>fooValues</span>, <span style=color:#a6e22e>bar</span>: <span style=color:#66d9ef>barValues</span> });
</span></span><span style=display:flex><span>		};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>reader</span>.<span style=color:#a6e22e>readAsBinaryString</span>(<span style=color:#a6e22e>file</span>);
</span></span><span style=display:flex><span>	};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;file&#34;</span> <span style=color:#a6e22e>accept</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;.xls,.xlsx,.csv&#34;</span> <span style=color:#a6e22e>onChange</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>handleChange</span>} /&gt;;
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#a6e22e>ExcelUploadComponent</span>;
</span></span></code></pre></div><h3 id=verdict-->Verdict: üëç üëç<a hidden class=anchor aria-hidden=true href=#verdict-->#</a></h3><ul><li><p>Now that, was <em>pretty</em> good. I have no idea how to use the xlsx utility, and have not looked at its documentation</p></li><li><p>Even though, I had to correct some typos and some other minor edits - this gave me a component that does exactly what I needed.</p></li><li><p>I&rsquo;d say this save me atleast 10-15 minutes of time googling for the api documentation and fumbling till I got it right.</p></li></ul><h1 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h1><p>All in all, I think having locally running LLMs that can help us with code is possibly <em>very</em> near</p><p>These current models, while don&rsquo;t really get things correct always, <em>do</em> provide a pretty handy tool and in situations where new territory / new apps are being made, I think they can make significant progress.</p><p>Something to note, is that once I provide more longer contexts, the model seems to make a lot more errors. This is potentially only model specific, so future experimentation is needed here.</p><h1 id=whats-next>What&rsquo;s next<a hidden class=anchor aria-hidden=true href=#whats-next>#</a></h1><p>There were quite a few things I didn&rsquo;t explore here. I will cover those in future posts.</p><p>Here&rsquo;s a list of a few things I&rsquo;m going to experiment next</p><ul><li><p>Providing more examples of <em>good</em> code, instead of trying to explicitly mention every detail we want</p></li><li><p>Comparing other models on similar exercises. Possibly making a benchmark test suite to compare them against.</p></li><li><p>Trying multi-agent setups. I having another LLM that can correct the first ones mistakes, or enter into a dialogue where two minds reach a better outcome is totally possible.</p></li></ul><p>&ndash; A hint on this, is that once it gets something wrong, and I add the mistake to the prompt - the next iteration of the output is usually much better.</p></div><footer class=post-footer><div style=display:flex;justify-content:center;align-items:center><iframe src=https://kilobytes.substack.com/embed width=480 height=320 style="border:1px solid #eee;background:#fff" frameborder=0 scrolling=no></iframe></div><ul class=post-tags><li><a href=https://Kshitij-Banerjee.github.io/tags/machine-learning/>machine-learning</a></li><li><a href=https://Kshitij-Banerjee.github.io/tags/ai/>AI</a></li></ul></footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//kshitij-banerjee.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
<script src=https://giscus.app/client.js data-repo=Kshitij-Banerjee/Kshitij-Banerjee.github.io data-repo-id=R_kgDOI1NsBg data-category=General data-category-id=DIC_kwDOI1NsBs4Cdf1h data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=preferred_color_scheme data-lang=en data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2024 <a href=https://Kshitij-Banerjee.github.io>KiloBytes by KB</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>